/* ===== HistoryPage ===== */

/* 滾軸 */
.history-page *::-webkit-scrollbar { width: 4px; height: 4px; }
.history-page *::-webkit-scrollbar-track { background: transparent; }
.history-page *::-webkit-scrollbar-thumb { background: var(--surface1); border-radius: 4px; }
.history-page *::-webkit-scrollbar-thumb:hover { background: var(--overlay0); }

/* 頁面 */
.history-page { display: flex; gap: 10px; height: calc(100vh - 80px); padding: 8px; }

/* 玻璃卡片 */
.h-card {
  background: var(--base);
  border-radius: var(--radius-card);
  border: 1px solid var(--surface0);
  transition: border-color var(--transition-normal), box-shadow var(--transition-normal);
}
.h-card:hover { border-color: var(--surface1); box-shadow: 0 4px 16px var(--shadow); }

/* Segment Control */
.hseg { display: flex; background: var(--surface0); border-radius: var(--radius-sm); padding: 2px; gap: 2px; }
.hseg button { padding: 4px 10px; font-size: 11px; border: none; border-radius: 4px; background: transparent; color: var(--subtext0); cursor: pointer; transition: all var(--transition-fast); white-space: nowrap; }
.hseg button.active { background: var(--accent, var(--blue)); color: var(--accent-text, var(--base)); font-weight: 500; }
.hseg button:not(.active):hover { background: var(--surface1); color: var(--text); }
.hseg.equal button { flex: 1; text-align: center; }
.hseg.lg button { padding: 5px 14px; font-size: 12px; }

/* 全頁空狀態 */
.history-full-empty { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 12px; color: var(--subtext0); font-size: 15px; }
.history-empty-icon { font-size: 36px; opacity: 0.5; }

/* Sidebar */
.history-sidebar { width: 250px; min-width: 210px; display: flex; flex-direction: column; gap: 8px; overflow: hidden; padding: 12px; }
.history-sidebar-header { display: flex; align-items: center; gap: 6px; }
.history-sidebar-title { font-size: 13px; font-weight: 600; color: var(--text); letter-spacing: 0.3px; }
.history-recording-badge { font-size: 10px; color: var(--green); font-weight: 500; margin-right: auto; }

/* 收合按鈕 */
.history-collapse-btn { width: 22px; height: 22px; border: none; border-radius: 4px; background: transparent; color: var(--subtext0); cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 10px; flex-shrink: 0; transition: all var(--transition-fast); }
.history-collapse-btn:hover { background: var(--surface0); color: var(--text); }

/* 搜尋 */
.history-search { width: 100%; padding: 6px 10px; font-size: 12px; border: 1px solid var(--surface0); border-radius: var(--radius-sm); background: var(--mantle); color: var(--text); outline: none; box-sizing: border-box; transition: border-color var(--transition-fast); }
.history-search:focus { border-color: var(--accent, var(--blue)); }

/* 批量 */
.history-batch-row { display: flex; align-items: center; gap: 4px; }
.history-batch-count { font-size: 10px; color: var(--subtext0); margin-right: auto; }
.history-batch-btn { padding: 3px 8px; font-size: 10px; border: 1px solid var(--surface1); border-radius: 4px; background: transparent; color: var(--subtext0); cursor: pointer; transition: all var(--transition-fast); }
.history-batch-btn:hover:not(:disabled) { background: var(--surface0); color: var(--text); }
.history-batch-btn.enable:hover:not(:disabled) { background: var(--green); color: var(--base); border-color: var(--green); }
.history-batch-btn.disable:hover:not(:disabled) { background: var(--red); color: var(--base); border-color: var(--red); }
.history-batch-btn:disabled { opacity: 0.35; cursor: default; }

/* 訂閱列表 */
.history-sub-list { flex: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 2px; }
.history-sub-item { display: flex; align-items: center; gap: 8px; padding: 6px 8px; border-radius: var(--radius-sm); cursor: pointer; color: var(--text); transition: background var(--transition-fast); }
.history-sub-item:hover { background: var(--surface0); }
.history-sub-item.selected { background: var(--accent, var(--blue)); color: var(--accent-text, var(--base)); }
.history-sub-item.selected .history-sub-meta { opacity: 0.8; }
.history-sub-info { flex: 1; min-width: 0; display: flex; flex-direction: column; gap: 1px; }
.history-sub-symbol { font-size: 12px; font-weight: 500; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.history-sub-meta { font-size: 10px; opacity: 0.55; display: flex; align-items: center; gap: 4px; }
.history-rec-dot { color: var(--green); font-size: 8px; }
.history-sub-item.selected .history-rec-dot { color: var(--accent-text, var(--base)); }

/* toggle */
.history-record-toggle { width: 15px; height: 15px; border-radius: 3px; border: 1.5px solid var(--surface1); background: transparent; cursor: pointer; display: flex; align-items: center; justify-content: center; flex-shrink: 0; padding: 0; font-size: 9px; color: var(--text); transition: all var(--transition-fast); }
.history-record-toggle.recording { background: var(--green); border-color: var(--green); color: var(--base); }
.history-sidebar-empty { padding: 20px 0; text-align: center; color: var(--subtext0); font-size: 12px; }

/* Sidebar icon */
.history-icon { width: 24px; height: 24px; border-radius: 50%; background: var(--surface0); display: flex; align-items: center; justify-content: center; overflow: hidden; flex-shrink: 0; }
.history-icon img { width: 100%; height: 100%; object-fit: cover; }
.history-icon .asset-icon-fallback { font-size: 8px; font-weight: bold; color: var(--subtext0); }
.history-dex-icons { display: flex; align-items: center; flex-shrink: 0; }
.history-dex-icons .history-icon { width: 20px; height: 20px; }
.history-dex-icons .history-icon + .history-icon { margin-left: -6px; }
.history-dex-icons .history-icon .asset-icon-fallback { font-size: 7px; }

/* 主內容 */
.history-main { flex: 1; display: flex; flex-direction: column; gap: 8px; overflow: hidden; }

/* Toolbar 資訊 */
.history-selected-name { font-size: 13px; font-weight: 600; color: var(--text); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 200px; }
.history-selected-provider { font-size: 11px; color: var(--subtext0); white-space: nowrap; }
.history-toolbar-hint { font-size: 12px; color: var(--subtext0); }
.history-status-badge { margin-left: auto; font-size: 10px; padding: 2px 10px; border-radius: var(--radius-pill); background: var(--surface0); color: var(--subtext0); }
.history-status-badge.recording { background: var(--green); color: var(--base); }

/* Toolbar */
.history-toolbar { display: flex; flex-direction: column; gap: 6px; padding: 8px 16px; }
.history-toolbar-row { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; }
.history-toolbar-divider { width: 1px; height: 20px; background: var(--surface1); flex-shrink: 0; }
.history-custom-range { display: flex; align-items: center; gap: 6px; font-size: 12px; color: var(--subtext0); }
.history-date-input { padding: 4px 8px; font-size: 11px; border: 1px solid var(--surface0); border-radius: 4px; background: var(--mantle); color: var(--text); }
.history-apply-btn { padding: 4px 12px; font-size: 11px; border: none; border-radius: 4px; background: var(--accent, var(--blue)); color: var(--accent-text, var(--base)); cursor: pointer; transition: opacity var(--transition-fast); }
.history-apply-btn:hover { opacity: 0.85; }
.history-spacer { flex: 1; }
.history-stats { font-size: 11px; color: var(--subtext0); }

/* Icon 按鈕 */
.history-icon-btn { width: 30px; height: 30px; border: 1px solid var(--surface0); border-radius: var(--radius-sm); background: transparent; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 14px; transition: all var(--transition-fast); flex-shrink: 0; }
.history-icon-btn:hover { background: var(--surface0); border-color: var(--surface1); }

/* 齒輪選單 */
.history-menu-wrap { position: relative; }
.history-menu { position: absolute; top: 100%; right: 0; margin-top: 4px; min-width: 150px; background: var(--base); border: 1px solid var(--surface0); border-radius: var(--radius-sm); box-shadow: 0 4px 16px var(--shadow); z-index: 50; padding: 4px; display: flex; flex-direction: column; gap: 2px; }
.history-menu button { padding: 6px 12px; font-size: 12px; border: none; border-radius: 4px; background: transparent; color: var(--text); cursor: pointer; text-align: left; transition: background var(--transition-fast); }
.history-menu button:hover { background: var(--surface0); }
.history-menu button.danger { color: var(--red); }
.history-menu button.danger:hover { background: var(--red); color: var(--base); }

/* 空狀態 */
.history-empty-state { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 10px; color: var(--subtext0); font-size: 14px; }
.history-enable-btn { margin-top: 4px; padding: 6px 18px; font-size: 12px; border: none; border-radius: var(--radius-sm); background: var(--accent, var(--blue)); color: var(--accent-text, var(--base)); cursor: pointer; transition: opacity var(--transition-fast); }
.history-enable-btn:hover { opacity: 0.85; }

/* 圖表 */
.history-chart-wrapper { flex: 1; display: flex; flex-direction: column; overflow: hidden; min-height: 300px; }
.history-chart-container { flex: 1; overflow: hidden; position: relative; min-height: 0; }

/* 表格 */
.history-table-container { flex: 1; overflow: auto; }
.history-table { width: 100%; border-collapse: collapse; font-size: 12px; }
.history-table th { position: sticky; top: 0; background: var(--base); padding: 8px 12px; text-align: left; font-weight: 600; color: var(--subtext0); border-bottom: 1px solid var(--surface0); font-size: 11px; }
.history-table td { padding: 6px 12px; color: var(--text); border-bottom: 1px solid var(--surface0); }
.history-table tr:hover td { background: var(--surface0); }

/* ===== Record Hours ===== */
.history-hours-badge { font-size: 9px; color: var(--teal); margin-left: 2px; }
.history-sub-item.selected .history-hours-badge { color: var(--accent-text, var(--base)); opacity: 0.8; }
.history-hours-editor { padding: 6px 8px 8px 40px; display: flex; flex-direction: column; gap: 4px; }
.history-hours-row { display: flex; align-items: center; gap: 6px; font-size: 11px; color: var(--subtext0); }
.history-hours-label { font-size: 10px; font-weight: 500; color: var(--text); white-space: nowrap; }
.history-hours-select { padding: 2px 4px; font-size: 11px; border: 1px solid var(--surface0); border-radius: 4px; background: var(--mantle); color: var(--text); outline: none; }
.history-hours-select:focus { border-color: var(--accent, var(--blue)); }
.history-hours-hint { font-size: 9px; color: var(--overlay0); }

.history-hours-hint.priority { color: var(--teal); font-weight: 500; }
